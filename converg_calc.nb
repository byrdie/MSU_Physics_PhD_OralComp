(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11808,        361]
NotebookOptionsPosition[     10828,        321]
NotebookOutlinePosition[     11168,        336]
CellTagsIndexPosition[     11125,        333]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"$Assumptions", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Lambda]", " ", ">", " ", "0"}], " ", "&&", " ", 
   RowBox[{"x", " ", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
   RowBox[{"y", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
   RowBox[{"z", ">", "0"}], "&&", " ", 
   RowBox[{"xp", " ", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
   RowBox[{"yp", " ", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
   RowBox[{"zp", ">", "0"}], " ", "&&", " ", 
   RowBox[{"x", " ", "\[Element]", " ", "Reals"}], "&&", " ", 
   RowBox[{"k", ">", "0"}], " ", "&&", " ", 
   RowBox[{"m", " ", "\[Element]", " ", "Integers"}], " ", "&&", " ", 
   RowBox[{"n", " ", "\[Element]", " ", "Integers"}], " ", "&&", " ", 
   RowBox[{"a", " ", ">", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.70007873807191*^9, 3.7000788149183617`*^9}, {
  3.700085852182394*^9, 3.70008585306454*^9}, {3.7000863236394377`*^9, 
  3.700086324695025*^9}, {3.700086394197551*^9, 3.700086480541329*^9}, {
  3.7000865503828363`*^9, 3.7000865525867367`*^9}, {3.7000875973177023`*^9, 
  3.700087598905822*^9}, {3.700149973768009*^9, 3.700149994407329*^9}, {
  3.70015026531279*^9, 3.700150267938798*^9}, {3.7002235602366133`*^9, 
  3.700223562682016*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", ">", "0"}], "&&", 
  RowBox[{"x", "\[Element]", "Reals"}], "&&", 
  RowBox[{"y", "\[Element]", "Reals"}], "&&", 
  RowBox[{"z", ">", "0"}], "&&", 
  RowBox[{"xp", "\[Element]", "Reals"}], "&&", 
  RowBox[{"yp", "\[Element]", "Reals"}], "&&", 
  RowBox[{"zp", ">", "0"}], "&&", 
  RowBox[{"x", "\[Element]", "Reals"}], "&&", 
  RowBox[{"k", ">", "0"}], "&&", 
  RowBox[{"m", "\[Element]", "Integers"}], "&&", 
  RowBox[{"n", "\[Element]", "Integers"}], "&&", 
  RowBox[{"a", ">", "0"}]}]], "Output",
 CellChangeTimes->{3.7000865536990547`*^9, 3.700087600069305*^9, 
  3.7001502716786003`*^9, 3.700190709582108*^9, 3.700222054621072*^9, 
  3.700222558971554*^9, 3.700223563521428*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Psi]", " ", "=", " ", 
  RowBox[{
   FractionBox["I", 
    RowBox[{"\[Lambda]", " ", "z", " ", "zp"}]], 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "k", " ", 
        RowBox[{"(", 
         RowBox[{"z", " ", "+", " ", 
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x", "-", "X"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y", "-", "Y"}], ")"}], "2"]}], 
           RowBox[{"2", " ", "z"}]]}], ")"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "k", " ", 
        RowBox[{"(", 
         RowBox[{"zp", " ", "+", " ", 
          FractionBox[
           RowBox[{
            SuperscriptBox["X", "2"], "+", 
            SuperscriptBox["Y", "2"]}], 
           RowBox[{"2", " ", "zp"}]]}], ")"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Y", ",", 
       RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7000784267427197`*^9, 3.700078567233575*^9}, {
  3.700080071257495*^9, 3.700080080414546*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.700078691693202*^9, 3.700079264173479*^9, 
  3.7000805242172613`*^9, 3.700086334335692*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"y", "-", "Y"}], ")"}], "2"], "+", 
    SuperscriptBox["Y", "2"]}], " ", "//", "Expand"}], "  ", "//", 
  "Factor"}]], "Input",
 CellChangeTimes->{{3.700079418231427*^9, 3.700079459011054*^9}, {
  3.700087258848125*^9, 3.7000872958715467`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["y", "2"], "-", 
  RowBox[{"2", " ", "y", " ", "Y"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["Y", "2"]}]}]], "Output",
 CellChangeTimes->{{3.7000794330209208`*^9, 3.700079459222053*^9}, 
   3.700080524245647*^9, {3.7000872639644136`*^9, 3.700087296079391*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "m", " ", "X"}], "a"], "]"}], 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"I", " ", "k", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "X"}], ")"}], "2"]}], 
        RowBox[{"2", " ", "z"}]]}], "-", 
      FractionBox[
       RowBox[{"I", " ", "k", " ", 
        SuperscriptBox["X", "2"]}], 
       RowBox[{"2", " ", "zp"}]]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"X", ",", 
     RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7000823454089212`*^9, 3.700082394881619*^9}, {
   3.7000864928410587`*^9, 3.700086616015629*^9}, {3.700086670185872*^9, 
   3.7000867507013807`*^9}, {3.700086992164201*^9, 3.700086992308199*^9}, {
   3.70008755484649*^9, 3.700087570687114*^9}, {3.700087990898552*^9, 
   3.7000879945719547`*^9}, {3.700147718162284*^9, 3.700147720533084*^9}, {
   3.700147785205271*^9, 3.700147797604659*^9}, {3.700148041148264*^9, 
   3.700148063776976*^9}, {3.700148160551799*^9, 3.700148161347845*^9}, {
   3.700148404947029*^9, 3.700148405759101*^9}, 3.700189589691246*^9, 
   3.700189694480872*^9, 3.7001907168632708`*^9, 3.7002229051694717`*^9, {
   3.700223291234887*^9, 3.700223327544059*^9}, {3.700224312980236*^9, 
   3.700224320865117*^9}, {3.700224663974289*^9, 3.70022468544639*^9}, {
   3.70022480171729*^9, 3.7002248087654552`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["k", "2"], " ", 
         SuperscriptBox["x", "2"]}], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["m", "2"], " ", 
         SuperscriptBox["\[Pi]", "2"], " ", "z", " ", "zp"}]}], ")"}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["a", "2"], " ", "k", " ", 
      RowBox[{"(", 
       RowBox[{"z", "+", "zp"}], ")"}]}]]}]], " ", 
  SqrtBox["\[Pi]"], " ", 
  SqrtBox[
   FractionBox[
    RowBox[{"z", " ", "zp"}], 
    RowBox[{"k", " ", 
     RowBox[{"(", 
      RowBox[{"z", "+", "zp"}], ")"}]}]]], " ", 
  RowBox[{"Cos", "[", 
   FractionBox[
    RowBox[{"2", " ", "m", " ", "\[Pi]", " ", "x", " ", "zp"}], 
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{"z", "+", "zp"}], ")"}]}]], "]"}]}]], "Output",
 CellChangeTimes->{3.7002229926410503`*^9, 3.7002234545019903`*^9, 
  3.7002246601969757`*^9, 3.700224796064803*^9, 3.700225026776568*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"Exp", "[", 
     RowBox[{"(", 
      RowBox[{"s", "+", "sp"}], ")"}], "]"}], 
    RowBox[{"s", " ", "+", "sp"}]], ",", 
   RowBox[{"{", 
    RowBox[{"s", ",", "Infinity", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7002294312513638`*^9, 3.700229533752387*^9}, {
   3.700229563836214*^9, 3.700229609069828*^9}, 3.7002296798412123`*^9, {
   3.700229923229288*^9, 3.700229929653948*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", "s"], " ", 
  RowBox[{"(", 
   InterpretationBox[
    RowBox[{
     FractionBox[
      SuperscriptBox["\[ExponentialE]", "sp"], "s"], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "sp"], " ", "sp"}], 
      SuperscriptBox["s", "2"]], "+", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", 
        FractionBox["1", "s"], "]"}], "3"],
      SeriesData[$CellContext`s, 
       DirectedInfinity[1], {}, 1, 3, 1],
      Editable->False]}],
    SeriesData[$CellContext`s, 
     DirectedInfinity[1], {
     E^$CellContext`sp, -E^$CellContext`sp $CellContext`sp}, 1, 3, 1],
    Editable->False], ")"}]}]], "Output",
 CellChangeTimes->{{3.700229460965678*^9, 3.700229534192234*^9}, {
   3.700229574955654*^9, 3.7002296095308743`*^9}, 3.700229680656706*^9, 
   3.700229930106822*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"si", "=", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"xi", " ", "-", "X"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"yi", "-", "Y"}], ")"}], "2"], "+", 
     SuperscriptBox["zi", "2"]}], ")"}], 
   RowBox[{"1", "/", "2"}]]}]], "Input",
 CellChangeTimes->{{3.700402834033403*^9, 3.7004028949144917`*^9}}],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "X"}], "+", "xi"}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Y"}], "+", "yi"}], ")"}], "2"], "+", 
   SuperscriptBox["zi", "2"]}]]], "Output",
 CellChangeTimes->{3.700402864700099*^9, 3.700402895512374*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"si", ",", 
   RowBox[{"{", 
    RowBox[{"zi", ",", "Infinity", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.700402866914816*^9, 3.7004028795628233`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"zi", "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["X", "2"], "-", 
     RowBox[{"2", " ", "X", " ", "xi"}], "+", 
     SuperscriptBox["xi", "2"], "+", 
     SuperscriptBox["Y", "2"], "-", 
     RowBox[{"2", " ", "Y", " ", "yi"}], "+", 
     SuperscriptBox["yi", "2"]}], 
    RowBox[{"2", " ", "zi"}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      FractionBox["1", "zi"], "]"}], "2"],
    SeriesData[$CellContext`zi, 
     DirectedInfinity[1], {}, -1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`zi, 
   DirectedInfinity[1], {
   1, 0, Rational[1, 2] ($CellContext`X^2 - 
     2 $CellContext`X $CellContext`xi + $CellContext`xi^2 + $CellContext`Y^2 - 
     2 $CellContext`Y $CellContext`yi + $CellContext`yi^2)}, -1, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.7004028798931913`*^9, 3.7004028977457323`*^9}}]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{2476, Automatic}, {0, Automatic}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1241, 21, 77, "Input"],
Cell[1824, 45, 729, 16, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2590, 66, 1197, 35, 93, "Input"],
Cell[3790, 103, 148, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3975, 110, 344, 10, 34, "Input"],
Cell[4322, 122, 307, 7, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4666, 134, 1543, 34, 61, "Input"],
Cell[6212, 170, 1185, 35, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7434, 210, 479, 12, 56, "Input"],
Cell[7916, 224, 890, 25, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8843, 254, 424, 13, 42, "Input"],
Cell[9270, 269, 360, 12, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9667, 286, 218, 5, 34, "Input"],
Cell[9888, 293, 924, 25, 54, "Output"]
}, Open  ]]
}
]
*)

